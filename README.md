# homehello
インターホンの音を拾ってIFTTTのWebhookに通知するやつ

## 対象
- 「ピンポン」って鳴るインターホン持ってる人
- マイク付きのラズパイかそれに準じるマシンを持っている人
- jsが嫌いじゃない人

## 動作環境
- Node.jsが入っている Raspberry Pi 4 で動かしています

## 使いかた
- まずifttt側にwebhook受けて反応するやつ作る
- .envファイルを作ってそこに以下を書く
  - `IFTTT_TRIGGER_NAME={IFTTTで作ったやつのトリガー名}`
  - `IFTTT_WEBHOOK_TOKEN={IFTTT側のWebhookトークン}`
- 動かすとずっとlisteningする。

## 開発者向け情報
### 仕組み
ピン・ポンそれぞれの周波数の音が一定時間内にある程度の長さで発生した時「インターホンがなった」と判定します。
ピン・ポンの順番は考慮されません。

### 検出する周波数を変えたい
ソースの
```
const TARGET_HZ_PING = 650;
const TARGET_HZ_PONG = 513;
```
のところを修正してください。
検出の遊びは`const TARGET_PLAY = 50;`でいじれます。

### 自宅のピンポン周波数がわからない
スマホのアプリで検出できるやつあります。フーリエ変換とかで検索するとヨシ。
